//
//  ZWEmoji.m
//  ZWEmoji
//
//  Created by Zach Waugh on 8/31/12.
//  Copyright (c) 2012 Zach Waugh. All rights reserved.
//

#import "ZWEmoji.h"

NSString * const ZWEmojiStringKey = @"string";
NSString * const ZWEmojiReplacedEmojiKey = @"emojis";

static NSDictionary *_emojis = nil;
static NSDictionary *_codes = nil;
static NSRegularExpression *_regex = nil;

@implementation ZWEmoji

+ (NSDictionary *)emojis
{
	return _emojis;
}

+ (NSDictionary *)codes
{
	return _codes;
}

+ (NSString *)codeForEmoji:(NSString *)emoji
{
	return [_emojis objectForKey:emoji];
}

+ (NSString *)emojiForCode:(NSString *)code
{
	return [_codes objectForKey:code];
}

// Replace emoji unicode (\U0001F44D) with Campfire codes (:thumbsup:)
+ (NSString *)stringByReplacingEmojiInString:(NSString *)string
{
	return [self stringByReplacingEmojiInString:string ignore:nil];
}

+ (NSString *)stringByReplacingEmojiInString:(NSString *)string ignore:(NSSet *)ignore
{
    if (![string isEqual:[NSNull null]] && [string length]) {

        NSMutableString *emojiString = [string mutableCopy];

        for (NSString *emoji in _emojis) {
            if (![ignore containsObject:emoji]) {
                [emojiString replaceOccurrencesOfString:emoji withString:[_emojis objectForKey:emoji] options:NSCaseInsensitiveSearch range:NSMakeRange(0, [emojiString length])];
            }
        }

        return emojiString;
    }
    return string;
}

// Replace codes (:thumbsup:) with emoji unicode (\U0001F44D)
+ (NSString *)stringByReplacingCodesInString:(NSString *)string
{
    if (![string isEqual:[NSNull null]] && [string length]) {
        NSDictionary *dict = [ZWEmoji replaceCodesInString:string];
        return [dict objectForKey:ZWEmojiStringKey];
    }
    return string;
}

// More info, returns string and a list of the all the emoji that were replaced
+ (NSDictionary *)replaceCodesInString:(NSString *)string
{
	// Return right away if no emoji codes in string
	if ([string rangeOfString:@":"].location == NSNotFound) {
		return [NSDictionary dictionaryWithObject:string forKey:ZWEmojiStringKey];
	}
	
	if (!_regex) {
		_regex = [NSRegularExpression regularExpressionWithPattern:@":[a-z0-9_+-]+:" options:NSRegularExpressionCaseInsensitive error:nil];
	}
	NSArray *matches = [_regex matchesInString:string options:0 range:NSMakeRange(0, [string length])];
	
	NSMutableString *emojiString = [string mutableCopy];
	NSMutableSet *replacedEmoji = [NSMutableSet set];
	
	// Loop through matches in reverse order so the ranges won't be affected
	for (NSTextCheckingResult *match in [matches reverseObjectEnumerator]) {
		NSString *word = [string substringWithRange:match.range];
		NSString *emoji = [ZWEmoji emojiForCode:word];
		
		if (emoji) {
			if (![replacedEmoji containsObject:emoji]) {
				[replacedEmoji addObject:emoji];
			}
			
			[emojiString replaceCharactersInRange:match.range withString:emoji];
		}
	}
	
	return [NSDictionary dictionaryWithObjectsAndKeys:emojiString, ZWEmojiStringKey, replacedEmoji, ZWEmojiReplacedEmojiKey, nil];
}

+ (void)initialize
{
	_codes = [[NSDictionary alloc] initWithObjectsAndKeys:
            @"\U0001F44D", @":+1:",
            @"\U0001F44E", @":-1:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0030, (unichar)0x20E3], @":0:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0031, (unichar)0x20E3], @":1:",
            @"\U0001F4AF", @":100:",
            @":109:", @":109:",
            @"\U0001F522", @":1234:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0032, (unichar)0x20E3], @":2:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0033, (unichar)0x20E3], @":3:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0034, (unichar)0x20E3], @":4:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0035, (unichar)0x20E3], @":5:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0036, (unichar)0x20E3], @":6:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0037, (unichar)0x20E3], @":7:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0038, (unichar)0x20E3], @":8:",
            @"\U0001F3B1", @":8ball:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0039, (unichar)0x20E3], @":9:",
            @"\U0001F170", @":a:",
            @"\U0001F18E", @":ab:",
            @"\U0001F524", @":abc:",
            @"\U0001F521", @":abcd:",
            @"\U0001F251", @":accept:",
            @"\U0001F6A1", @":aerial_tramway:",
            @"\u2708", @":airplane:",
            @"\u23F0", @":alarm_clock:",
            @"\U0001F47D", @":alien:",
            @"\U0001F691", @":ambulance:",
            @"\u2693", @":anchor:",
            @"\U0001F47C", @":angel:",
            @"\U0001F4A2", @":anger:",
            @"\U0001F620", @":angry:",
            @"\U0001F627", @":anguished:",
            @"\U0001F41C", @":ant:",
            @"\U0001F34E", @":apple:",
            @"\u2652", @":aquarius:",
            @"\u2648", @":aries:",
            @"\u25C0", @":arrow_backward:",
            @"\u23EC", @":arrow_double_down:",
            @"\u23EB", @":arrow_double_up:",
            @"\u2B07", @":arrow_down:",
            @"\U0001F53D", @":arrow_down_small:",
            @"\u25B6", @":arrow_forward:",
            @"\u2935", @":arrow_heading_down:",
            @"\u2934", @":arrow_heading_up:",
            @"\u2B05", @":arrow_left:",
            @"\u2199", @":arrow_lower_left:",
            @"\u2198", @":arrow_lower_right:",
            @"\u27A1", @":arrow_right:",
            @"\u21AA", @":arrow_right_hook:",
            @"\u2B06", @":arrow_up:",
            @"\u2195", @":arrow_up_down:",
            @"\U0001F53C", @":arrow_up_small:",
            @"\u2196", @":arrow_upper_left:",
            @"\u2197", @":arrow_upper_right:",
            @"\U0001F503", @":arrows_clockwise:",
            @"\U0001F504", @":arrows_counterclockwise:",
            @"\U0001F3A8", @":art:",
            @"\U0001F69B", @":articulated_lorry:",
            @"\U0001F632", @":astonished:",
            @"\U0001F3E7", @":atm:",
            @"\U0001F171", @":b:",
            @"\U0001F476", @":baby:",
            @"\U0001F37C", @":baby_bottle:",
            @"\U0001F424", @":baby_chick:",
            @"\U0001F6BC", @":baby_symbol:",
            @"\U0001F6C4", @":baggage_claim:",
            @"\U0001F388", @":balloon:",
            @"\u2611", @":ballot_box_with_check:",
            @"\U0001F38D", @":bamboo:",
            @"\U0001F34C", @":banana:",
            @"\u203C", @":bangbang:",
            @"\U0001F3E6", @":bank:",
            @"\U0001F4CA", @":bar_chart:",
            @"\U0001F488", @":barber:",
            @"\u26BE", @":baseball:",
            @"\U0001F3C0", @":basketball:",
            @"\U0001F6C0", @":bath:",
            @"\U0001F6C1", @":bathtub:",
            @"\U0001F50B", @":battery:",
            @"\U0001F43B", @":bear:",
            @"\U0001F41D", @":bee:",
            @"\U0001F37A", @":beer:",
            @"\U0001F37B", @":beers:",
            @"\U0001F41E", @":beetle:",
            @"\U0001F530", @":beginner:",
            @"\U0001F514", @":bell:",
            @"\U0001F371", @":bento:",
            @"\U0001F6B4", @":bicyclist:",
            @"\U0001F6B2", @":bike:",
            @"\U0001F459", @":bikini:",
            @"\U0001F426", @":bird:",
            @"\U0001F382", @":birthday:",
            @"\u26AB", @":black_circle:",
            @"\U0001F0CF", @":black_joker:",
            @"\u2712", @":black_nib:",
            @"\u25FC", @":black_square:",
            @"\U0001F532", @":black_square_button:",
            @"\U0001F33C", @":blossom:",
            @"\U0001F421", @":blowfish:",
            @"\U0001F4D8", @":blue_book:",
            @"\U0001F699", @":blue_car:",
            @"\U0001F499", @":blue_heart:",
            @"\U0001F60A", @":blush:",
            @"\U0001F417", @":boar:",
            @"\u26F5", @":boat:",
            @"\U0001F4A3", @":bomb:",
            @"\U0001F4D6", @":book:",
            @"\U0001F516", @":bookmark:",
            @"\U0001F4D1", @":bookmark_tabs:",
            @"\U0001F4DA", @":books:",
            @"\U0001F4A5", @":boom:",
            @"\U0001F462", @":boot:",
            @"\U0001F490", @":bouquet:",
            @"\U0001F647", @":bow:",
            @"\U0001F3B3", @":bowling:",
            @":bowtie:", @":bowtie:",
            @"\U0001F466", @":boy:",
            @"\U0001F35E", @":bread:",
            @"\U0001F470", @":bride_with_veil:",
            @"\U0001F309", @":bridge_at_night:",
            @"\U0001F4BC", @":briefcase:",
            @"\U0001F494", @":broken_heart:",
            @"\U0001F41B", @":bug:",
            @"\U0001F4A1", @":bulb:",
            @"\U0001F685", @":bullettrain_front:",
            @"\U0001F684", @":bullettrain_side:",
            @"\U0001F68C", @":bus:",
            @"\U0001F68F", @":busstop:",
            @"\U0001F464", @":bust_in_silhouette:",
            @"\U0001F465", @":busts_in_silhouette:",
            @"\U0001F335", @":cactus:",
            @"\U0001F370", @":cake:",
            @"\U0001F4C6", @":calendar:",
            @"\U0001F4F2", @":calling:",
            @"\U0001F42B", @":camel:",
            @"\U0001F4F7", @":camera:",
            @"\u264B", @":cancer:",
            @"\U0001F36C", @":candy:",
            @"\U0001F520", @":capital_abcd:",
            @"\u2651", @":capricorn:",
            @"\U0001F697", @":car:",
            @"\U0001F4C7", @":card_index:",
            @"\U0001F3A0", @":carousel_horse:",
            @"\U0001F431", @":cat:",
            @"\U0001F408", @":cat2:",
            @"\U0001F4BF", @":cd:",
            @"\U0001F4B9", @":chart:",
            @"\U0001F4C9", @":chart_with_downwards_trend:",
            @"\U0001F4C8", @":chart_with_upwards_trend:",
            @"\U0001F3C1", @":checkered_flag:",
            @"\U0001F352", @":cherries:",
            @"\U0001F338", @":cherry_blossom:",
            @"\U0001F330", @":chestnut:",
            @"\U0001F414", @":chicken:",
            @"\U0001F6B8", @":children_crossing:",
            @"\U0001F36B", @":chocolate_bar:",
            @"\U0001F384", @":christmas_tree:",
            @"\u26EA", @":church:",
            @"\U0001F3A6", @":cinema:",
            @"\U0001F3AA", @":circus_tent:",
            @"\U0001F307", @":city_sunrise:",
            @"\U0001F306", @":city_sunset:",
            @"\U0001F191", @":cl:",
            @"\U0001F44F", @":clap:",
            @"\U0001F3AC", @":clapper:",
            @"\U0001F4CB", @":clipboard:",
            @"\U0001F550", @":clock1:",
            @"\U0001F559", @":clock10:",
            @"\U0001F565", @":clock1030:",
            @"\U0001F55A", @":clock11:",
            @"\U0001F566", @":clock1130:",
            @"\U0001F55B", @":clock12:",
            @"\U0001F567", @":clock1230:",
            @"\U0001F55C", @":clock130:",
            @"\U0001F551", @":clock2:",
            @"\U0001F55D", @":clock230:",
            @"\U0001F552", @":clock3:",
            @"\U0001F55E", @":clock330:",
            @"\U0001F553", @":clock4:",
            @"\U0001F55F", @":clock430:",
            @"\U0001F554", @":clock5:",
            @"\U0001F560", @":clock530:",
            @"\U0001F555", @":clock6:",
            @"\U0001F561", @":clock630:",
            @"\U0001F556", @":clock7:",
            @"\U0001F562", @":clock730:",
            @"\U0001F557", @":clock8:",
            @"\U0001F563", @":clock830:",
            @"\U0001F558", @":clock9:",
            @"\U0001F564", @":clock930:",
            @"\U0001F4D5", @":closed_book:",
            @"\U0001F510", @":closed_lock_with_key:",
            @"\U0001F302", @":closed_umbrella:",
            @"\u2601", @":cloud:",
            @"\u2663", @":clubs:",
            [NSString stringWithFormat:@"\U0001F1E8\U0001F1F3"], @":cn:",
            @"\U0001F378", @":cocktail:",
            @"\u2615", @":coffee:",
            @"\U0001F630", @":cold_sweat:",
            @"\U0001F4A5", @":collision:",
            @"\U0001F4BB", @":computer:",
            @"\U0001F38A", @":confetti_ball:",
            @"\U0001F616", @":confounded:",
            @"\U0001F615", @":confused:",
            @"\u3297", @":congratulations:",
            @"\U0001F6A7", @":construction:",
            @"\U0001F477", @":construction_worker:",
            @"\U0001F3EA", @":convenience_store:",
            @"\U0001F36A", @":cookie:",
            @"\U0001F192", @":cool:",
            @"\U0001F46E", @":cop:",
            @"\u00A9", @":copyright:",
            @"\U0001F33D", @":corn:",
            @"\U0001F46B", @":couple:",
            @"\U0001F491", @":couple_with_heart:",
            @"\U0001F48F", @":couplekiss:",
            @"\U0001F42E", @":cow:",
            @"\U0001F404", @":cow2:",
            @"\U0001F4B3", @":credit_card:",
            @"\U0001F40A", @":crocodile:",
            @"\U0001F38C", @":crossed_flags:",
            @"\U0001F451", @":crown:",
            @"\U0001F622", @":cry:",
            @"\U0001F63F", @":crying_cat_face:",
            @"\U0001F52E", @":crystal_ball:",
            @"\U0001F498", @":cupid:",
            @"\u27B0", @":curly_loop:",
            @"\U0001F4B1", @":currency_exchange:",
            @"\U0001F35B", @":curry:",
            @"\U0001F36E", @":custard:",
            @"\U0001F6C3", @":customs:",
            @"\U0001F300", @":cyclone:",
            @"\U0001F483", @":dancer:",
            @"\U0001F46F", @":dancers:",
            @"\U0001F361", @":dango:",
            @"\U0001F3AF", @":dart:",
            @"\U0001F4A8", @":dash:",
            @"\U0001F4C5", @":date:",
            [NSString stringWithFormat:@"\U0001F1E9\U0001F1EA"], @":de:",
            @"\U0001F333", @":deciduous_tree:",
            @"\U0001F3EC", @":department_store:",
            @"\U0001F4A0", @":diamond_shape_with_a_dot_inside:",
            @"\u2666", @":diamonds:",
            @"\U0001F61E", @":disappointed:",
            @"\U0001F4AB", @":dizzy:",
            @"\U0001F635", @":dizzy_face:",
            @"\U0001F6AF", @":do_not_litter:",
            @"\U0001F436", @":dog:",
            @"\U0001F415", @":dog2:",
            @"\U0001F4B5", @":dollar:",
            @"\U0001F38E", @":dolls:",
            @"\U0001F42C", @":dolphin:",
            @"\U0001F6AA", @":door:",
            @"\U0001F369", @":doughnut:",
            @"\U0001F409", @":dragon:",
            @"\U0001F432", @":dragon_face:",
            @"\U0001F457", @":dress:",
            @"\U0001F42A", @":dromedary_camel:",
            @"\U0001F4A7", @":droplet:",
            @"\U0001F4C0", @":dvd:",
            @"\U0001F4E7", @":e-mail:",
            @"\U0001F442", @":ear:",
            @"\U0001F33E", @":ear_of_rice:",
            @"\U0001F30D", @":earth_africa:",
            @"\U0001F30E", @":earth_americas:",
            @"\U0001F30F", @":earth_asia:",
            @"\U0001F373", @":egg:",
            @"\U0001F346", @":eggplant:",
            @"\u2734", @":eight_pointed_black_star:",
            @"\u2733", @":eight_spoked_asterisk:",
            @"\U0001F50C", @":electric_plug:",
            @"\U0001F418", @":elephant:",
            @"\U0001F4E9", @":email:",
            @"\U0001F51A", @":end:",
            @"\u2709", @":envelope:",
            [NSString stringWithFormat:@"\U0001F1EA\U0001F1F8"], @":es:",
            @"\U0001F4B6", @":euro:",
            @"\U0001F3F0", @":european_castle:",
            @"\U0001F3E4", @":european_post_office:",
            @"\U0001F332", @":evergreen_tree:",
            @"\u2755", @":exclamation:",
            @"\U0001F611", @":expressionless:",
            @"\U0001F453", @":eyeglasses:",
            @"\U0001F440", @":eyes:",
            @"\U0001F44A", @":facepunch:",
            @"\U0001F3ED", @":factory:",
            @"\U0001F342", @":fallen_leaf:",
            @"\U0001F46A", @":family:",
            @"\u23E9", @":fast_forward:",
            @"\U0001F4E0", @":fax:",
            @"\U0001F628", @":fearful:",
            @":feelsgood:", @":feelsgood:",
            @"\U0001F463", @":feet:",
            @"\U0001F3A1", @":ferris_wheel:",
            @"\U0001F4C1", @":file_folder:",
            @":finnadie:", @":finnadie:",
            @"\U0001F525", @":fire:",
            @"\U0001F692", @":fire_engine:",
            @"\U0001F386", @":fireworks:",
            @"\U0001F313", @":first_quarter_moon:",
            @"\U0001F31B", @":first_quarter_moon_with_face:",
            @"\U0001F41F", @":fish:",
            @"\U0001F365", @":fish_cake:",
            @"\U0001F3A3", @":fishing_pole_and_fish:",
            @"\u270A", @":fist:",
            @"\U0001F38F", @":flags:",
            @"\U0001F526", @":flashlight:",
            @"\U0001F4BE", @":floppy_disk:",
            @"\U0001F3B4", @":flower_playing_cards:",
            @"\U0001F633", @":flushed:",
            @"\U0001F301", @":foggy:",
            @"\U0001F3C8", @":football:",
            @"\U0001F374", @":fork_and_knife:",
            @"\u26F2", @":fountain:",
            @"\U0001F340", @":four_leaf_clover:",
            [NSString stringWithFormat:@"\U0001F1EB\U0001F1F7"], @":fr:",
            @"\U0001F193", @":free:",
            @"\U0001F364", @":fried_shrimp:",
            @"\U0001F35F", @":fries:",
            @"\U0001F438", @":frog:",
            @"\U0001F626", @":frowning:",
            @"\u26FD", @":fuelpump:",
            @"\U0001F315", @":full_moon:",
            @"\U0001F31D", @":full_moon_with_face:",
            @"\U0001F3B2", @":game_die:",
            [NSString stringWithFormat:@"\U0001F1EC\U0001F1E7"], @":gb:",
            @"\U0001F48E", @":gem:",
            @"\u264A", @":gemini:",
            @"\U0001F47B", @":ghost:",
            @"\U0001F381", @":gift:",
            @"\U0001F49D", @":gift_heart:",
            @"\U0001F467", @":girl:",
            @"\U0001F310", @":globe_with_meridians:",
            @"\U0001F410", @":goat:",
            @":goberserk:", @":goberserk:",
            @":godmode:", @":godmode:",
            @"\u26F3", @":golf:",
            @"\U0001F347", @":grapes:",
            @"\U0001F34F", @":green_apple:",
            @"\U0001F4D7", @":green_book:",
            @"\U0001F49A", @":green_heart:",
            @"\u2755", @":grey_exclamation:",
            @"\u2754", @":grey_question:",
            @"\U0001F62C", @":grimacing:",
            @"\U0001F601", @":grin:",
            @"\U0001F600", @":grinning:",
            @"\U0001F482", @":guardsman:",
            @"\U0001F3B8", @":guitar:",
            @"\U0001F52B", @":gun:",
            @"\U0001F487", @":haircut:",
            @"\U0001F354", @":hamburger:",
            @"\U0001F528", @":hammer:",
            @"\U0001F439", @":hamster:",
            @"\u270B", @":hand:",
            @"\U0001F45C", @":handbag:",
            @"\U0001F4A9", @":hankey:",
            [NSString stringWithFormat:@"%C%C", (unichar)0x0023, (unichar)0x20E3], @":hash:",
            @"\U0001F425", @":hatched_chick:",
            @"\U0001F423", @":hatching_chick:",
            @"\U0001F3A7", @":headphones:",
            @"\U0001F649", @":hear_no_evil:",
            @"\u2764", @":heart:",
            @"\U0001F49F", @":heart_decoration:",
            @"\U0001F60D", @":heart_eyes:",
            @"\U0001F63B", @":heart_eyes_cat:",
            @"\U0001F493", @":heartbeat:",
            @"\U0001F497", @":heartpulse:",
            @"\u2665", @":hearts:",
            @"\u2714", @":heavy_check_mark:",
            @"\u2797", @":heavy_division_sign:",
            @"\U0001F4B2", @":heavy_dollar_sign:",
            @"\u2757", @":heavy_exclamation_mark:",
            @"\u2796", @":heavy_minus_sign:",
            @"\u2716", @":heavy_multiplication_x:",
            @"\u2795", @":heavy_plus_sign:",
            @"\U0001F681", @":helicopter:",
            @"\U0001F33F", @":herb:",
            @"\U0001F33A", @":hibiscus:",
            @"\U0001F506", @":high_brightness:",
            @"\U0001F460", @":high_heel:",
            @"\U0001F52A", @":hocho:",
            @"\U0001F36F", @":honey_pot:",
            @"\U0001F41D", @":honeybee:",
            @"\U0001F434", @":horse:",
            @"\U0001F3C7", @":horse_racing:",
            @"\U0001F3E5", @":hospital:",
            @"\U0001F3E8", @":hotel:",
            @"\u2668", @":hotsprings:",
            @"\u23F3", @":hourglass:",
            @"\u23F3", @":hourglass_flowing_sand:",
            @"\U0001F3E0", @":house:",
            @"\U0001F3E1", @":house_with_garden:",
            @":hurtrealbad:", @":hurtrealbad:",
            @"\U0001F62F", @":hushed:",
            @"\U0001F368", @":ice_cream:",
            @"\U0001F366", @":icecream:",
            @"\U0001F194", @":id:",
            @"\U0001F250", @":ideograph_advantage:",
            @"\U0001F47F", @":imp:",
            @"\U0001F4E5", @":inbox_tray:",
            @"\U0001F4E8", @":incoming_envelope:",
            @"\U0001F481", @":information_desk_person:",
            @"\u2139", @":information_source:",
            @"\U0001F607", @":innocent:",
            @"\u2049", @":interrobang:",
            @"\U0001F4F1", @":iphone:",
            [NSString stringWithFormat:@"\U0001F1EE\U0001F1F9"], @":it:",
            @"\U0001F3EE", @":izakaya_lantern:",
            @"\U0001F383", @":jack_o_lantern:",
            @"\U0001F5FE", @":japan:",
            @"\U0001F3EF", @":japanese_castle:",
            @"\U0001F47A", @":japanese_goblin:",
            @"\U0001F479", @":japanese_ogre:",
            @"\U0001F456", @":jeans:",
            @"\U0001F602", @":joy:",
            @"\U0001F639", @":joy_cat:",
            [NSString stringWithFormat:@"\U0001F1EF\U0001F1F5"], @":jp:",
            @"\U0001F511", @":key:",
            @"\U0001F51F", @":keycap_ten:",
            @"\U0001F458", @":kimono:",
            @"\U0001F48B", @":kiss:",
            @"\U0001F617", @":kissing:",
            @"\U0001F63D", @":kissing_cat:",
            @"\U0001F61A", @":kissing_closed_eyes:",
            @"\U0001F61A", @":kissing_face:",
            @"\U0001F618", @":kissing_heart:",
            @"\U0001F619", @":kissing_smiling_eyes:",
            @"\U0001F428", @":koala:",
            @"\U0001F201", @":koko:",
            [NSString stringWithFormat:@"\U0001F1F0\U0001F1F7"], @":kr:",
            @"\U0001F535", @":large_blue_circle:",
            @"\U0001F537", @":large_blue_diamond:",
            @"\U0001F536", @":large_orange_diamond:",
            @"\U0001F317", @":last_quarter_moon:",
            @"\U0001F31C", @":last_quarter_moon_with_face:",
            @"\U0001F606", @":laughing:",
            @"\U0001F343", @":leaves:",
            @"\U0001F4D2", @":ledger:",
            @"\U0001F6C5", @":left_luggage:",
            @"\u2194", @":left_right_arrow:",
            @"\u21A9", @":leftwards_arrow_with_hook:",
            @"\U0001F34B", @":lemon:",
            @"\u264C", @":leo:",
            @"\U0001F406", @":leopard:",
            @"\u264E", @":libra:",
            @"\U0001F688", @":light_rail:",
            @"\U0001F517", @":link:",
            @"\U0001F444", @":lips:",
            @"\U0001F484", @":lipstick:",
            @"\U0001F512", @":lock:",
            @"\U0001F50F", @":lock_with_ink_pen:",
            @"\U0001F36D", @":lollipop:",
            @"\u27BF", @":loop:",
            @"\U0001F4E2", @":loudspeaker:",
            @"\U0001F3E9", @":love_hotel:",
            @"\U0001F48C", @":love_letter:",
            @"\U0001F505", @":low_brightness:",
            @"\u24C2", @":m:",
            @"\U0001F50D", @":mag:",
            @"\U0001F50E", @":mag_right:",
            @"\U0001F004", @":mahjong:",
            @"\U0001F4EB", @":mailbox:",
            @"\U0001F4EA", @":mailbox_closed:",
            @"\U0001F4EC", @":mailbox_with_mail:",
            @"\U0001F4ED", @":mailbox_with_no_mail:",
            @"\U0001F468", @":man:",
            @"\U0001F472", @":man_with_gua_pi_mao:",
            @"\U0001F473", @":man_with_turban:",
            @"\U0001F45E", @":mans_shoe:",
            @"\U0001F341", @":maple_leaf:",
            @"\U0001F637", @":mask:",
            @"\U0001F486", @":massage:",
            @"\U0001F356", @":meat_on_bone:",
            @"\U0001F4E3", @":mega:",
            @"\U0001F348", @":melon:",
            @"\U0001F4DD", @":memo:",
            @"\U0001F6B9", @":mens:",
            @":metal:", @":metal:",
            @"\U0001F687", @":metro:",
            @"\U0001F3A4", @":microphone:",
            @"\U0001F52C", @":microscope:",
            @"\U0001F30C", @":milky_way:",
            @"\U0001F690", @":minibus:",
            @"\U0001F4BD", @":minidisc:",
            @"\U0001F4F4", @":mobile_phone_off:",
            @"\U0001F4B8", @":money_with_wings:",
            @"\U0001F4B0", @":moneybag:",
            @"\U0001F412", @":monkey:",
            @"\U0001F435", @":monkey_face:",
            @"\U0001F69D", @":monorail:",
            @"\U0001F319", @":moon:",
            @"\U0001F393", @":mortar_board:",
            @"\U0001F5FB", @":mount_fuji:",
            @"\U0001F6B5", @":mountain_bicyclist:",
            @"\U0001F6A0", @":mountain_cableway:",
            @"\U0001F69E", @":mountain_railway:",
            @"\U0001F42D", @":mouse:",
            @"\U0001F401", @":mouse2:",
            @"\U0001F3A5", @":movie_camera:",
            @"\U0001F5FF", @":moyai:",
            @"\U0001F4AA", @":muscle:",
            @"\U0001F344", @":mushroom:",
            @"\U0001F3B9", @":musical_keyboard:",
            @"\U0001F3B5", @":musical_note:",
            @"\U0001F3BC", @":musical_score:",
            @"\U0001F507", @":mute:",
            @"\U0001F485", @":nail_care:",
            @"\U0001F4DB", @":name_badge:",
            @":neckbeard:", @":neckbeard:",
            @"\U0001F454", @":necktie:",
            @"\u274E", @":negative_squared_cross_mark:",
            @"\U0001F610", @":neutral_face:",
            @"\U0001F195", @":new:",
            @"\U0001F311", @":new_moon:",
            @"\U0001F31A", @":new_moon_with_face:",
            @"\U0001F4F0", @":newspaper:",
            @"\U0001F196", @":ng:",
            @"\U0001F515", @":no_bell:",
            @"\U0001F6B3", @":no_bicycles:",
            @"\u26D4", @":no_entry:",
            @"\U0001F6AB", @":no_entry_sign:",
            @"\U0001F645", @":no_good:",
            @"\U0001F4F5", @":no_mobile_phones:",
            @"\U0001F636", @":no_mouth:",
            @"\U0001F6B7", @":no_pedestrians:",
            @"\U0001F6AD", @":no_smoking:",
            @"\U0001F6B1", @":non-potable_water:",
            @"\U0001F443", @":nose:",
            @"\U0001F4D3", @":notebook:",
            @"\U0001F4D4", @":notebook_with_decorative_cover:",
            @"\U0001F3B6", @":notes:",
            @"\U0001F529", @":nut_and_bolt:",
            @"\u2B55", @":o:",
            @"\U0001F17E", @":o2:",
            @"\U0001F30A", @":ocean:",
            @":octocat:", @":octocat:",
            @"\U0001F419", @":octopus:",
            @"\U0001F362", @":oden:",
            @"\U0001F3E2", @":office:",
            @"\U0001F197", @":ok:",
            @"\U0001F44C", @":ok_hand:",
            @"\U0001F646", @":ok_woman:",
            @"\U0001F474", @":older_man:",
            @"\U0001F475", @":older_woman:",
            @"\U0001F51B", @":on:",
            @"\U0001F698", @":oncoming_automobile:",
            @"\U0001F68D", @":oncoming_bus:",
            @"\U0001F694", @":oncoming_police_car:",
            @"\U0001F696", @":oncoming_taxi:",
            @"\U0001F4C2", @":open_file_folder:",
            @"\U0001F450", @":open_hands:",
            @"\U0001F62E", @":open_mouth:",
            @"\u26CE", @":ophiuchus:",
            @"\U0001F4D9", @":orange_book:",
            @"\U0001F4E4", @":outbox_tray:",
            @"\U0001F402", @":ox:",
            @"\U0001F4C4", @":page_facing_up:",
            @"\U0001F4C3", @":page_with_curl:",
            @"\U0001F4DF", @":pager:",
            @"\U0001F334", @":palm_tree:",
            @"\U0001F43C", @":panda_face:",
            @"\U0001F4CE", @":paperclip:",
            @"\U0001F17F", @":parking:",
            @"\u303D", @":part_alternation_mark:",
            @"\u26C5", @":partly_sunny:",
            @"\U0001F6C2", @":passport_control:",
            @"\U0001F43E", @":paw_prints:",
            @"\U0001F351", @":peach:",
            @"\U0001F350", @":pear:",
            @"\U0001F4DD", @":pencil:",
            @"\u270F", @":pencil2:",
            @"\U0001F427", @":penguin:",
            @"\U0001F614", @":pensive:",
            @"\U0001F3AD", @":performing_arts:",
            @"\U0001F623", @":persevere:",
            @"\U0001F64D", @":person_frowning:",
            @"\U0001F471", @":person_with_blond_hair:",
            @"\U0001F64E", @":person_with_pouting_face:",
            @"\u260E", @":phone:",
            @"\U0001F437", @":pig:",
            @"\U0001F416", @":pig2:",
            @"\U0001F43D", @":pig_nose:",
            @"\U0001F48A", @":pill:",
            @"\U0001F34D", @":pineapple:",
            @"\u2653", @":pisces:",
            @"\U0001F355", @":pizza:",
            @"\U0001F447", @":point_down:",
            @"\U0001F448", @":point_left:",
            @"\U0001F449", @":point_right:",
            @"\u261D", @":point_up:",
            @"\U0001F446", @":point_up_2:",
            @"\U0001F693", @":police_car:",
            @"\U0001F429", @":poodle:",
            @"\U0001F4A9", @":poop:",
            @"\U0001F3E3", @":post_office:",
            @"\U0001F4EF", @":postal_horn:",
            @"\U0001F4EE", @":postbox:",
            @"\U0001F6B0", @":potable_water:",
            @"\U0001F45D", @":pouch:",
            @"\U0001F357", @":poultry_leg:",
            @"\U0001F4B7", @":pound:",
            @"\U0001F63E", @":pouting_cat:",
            @"\U0001F64F", @":pray:",
            @"\U0001F478", @":princess:",
            @"\U0001F44A", @":punch:",
            @"\U0001F49C", @":purple_heart:",
            @"\U0001F45B", @":purse:",
            @"\U0001F4CC", @":pushpin:",
            @"\U0001F6AE", @":put_litter_in_its_place:",
            @"\u2754", @":question:",
            @"\U0001F430", @":rabbit:",
            @"\U0001F407", @":rabbit2:",
            @"\U0001F40E", @":racehorse:",
            @"\U0001F4FB", @":radio:",
            @"\U0001F518", @":radio_button:",
            @"\U0001F621", @":rage:",
            @":rage1:", @":rage1:",
            @":rage2:", @":rage2:",
            @":rage3:", @":rage3:",
            @":rage4:", @":rage4:",
            @"\U0001F683", @":railway_car:",
            @"\U0001F308", @":rainbow:",
            @"\U0001F64B", @":raised_hand:",
            @"\U0001F64C", @":raised_hands:",
            @"\U0001F40F", @":ram:",
            @"\U0001F35C", @":ramen:",
            @"\U0001F400", @":rat:",
            @"\u267B", @":recycle:",
            @"\U0001F697", @":red_car:",
            @"\U0001F534", @":red_circle:",
            @"\u00AE", @":registered:",
            @"\u263A", @":relaxed:",
            @"\U0001F625", @":relieved:",
            @"\U0001F501", @":repeat:",
            @"\U0001F502", @":repeat_one:",
            @"\U0001F6BB", @":restroom:",
            @"\U0001F49E", @":revolving_hearts:",
            @"\u23EA", @":rewind:",
            @"\U0001F380", @":ribbon:",
            @"\U0001F35A", @":rice:",
            @"\U0001F359", @":rice_ball:",
            @"\U0001F358", @":rice_cracker:",
            @"\U0001F391", @":rice_scene:",
            @"\U0001F48D", @":ring:",
            @"\U0001F680", @":rocket:",
            @"\U0001F3A2", @":roller_coaster:",
            @"\U0001F413", @":rooster:",
            @"\U0001F339", @":rose:",
            @"\U0001F6A8", @":rotating_light:",
            @"\U0001F4CD", @":round_pushpin:",
            @"\U0001F6A3", @":rowboat:",
            [NSString stringWithFormat:@"\U0001F1F7\U0001F1FA"], @":ru:",
            @"\U0001F3C9", @":rugby_football:",
            @"\U0001F3C3", @":runner:",
            @"\U0001F3C3", @":running:",
            @"\U0001F3BD", @":running_shirt_with_sash:",
            @"\U0001F202", @":sa:",
            @"\u2650", @":sagittarius:",
            @"\u26F5", @":sailboat:",
            @"\U0001F376", @":sake:",
            @"\U0001F461", @":sandal:",
            @"\U0001F385", @":santa:",
            @"\U0001F4E1", @":satellite:",
            @"\U0001F60C", @":satisfied:",
            @"\U0001F3B7", @":saxophone:",
            @"\U0001F3EB", @":school:",
            @"\U0001F392", @":school_satchel:",
            @"\u2702", @":scissors:",
            @"\u264F", @":scorpius:",
            @"\U0001F631", @":scream:",
            @"\U0001F640", @":scream_cat:",
            @"\U0001F4DC", @":scroll:",
            @"\U0001F4BA", @":seat:",
            @"\u3299", @":secret:",
            @"\U0001F648", @":see_no_evil:",
            @"\U0001F331", @":seedling:",
            @"\U0001F367", @":shaved_ice:",
            @"\U0001F411", @":sheep:",
            @"\U0001F41A", @":shell:",
            @"\U0001F6A2", @":ship:",
            @":shipit:", @":shipit:",
            @"\U0001F455", @":shirt:",
            @"\U0001F4A9", @":shit:",
            @"\U0001F45F", @":shoe:",
            @"\U0001F6BF", @":shower:",
            @"\U0001F4F6", @":signal_strength:",
            @"\U0001F52F", @":six_pointed_star:",
            @"\U0001F3BF", @":ski:",
            @"\U0001F480", @":skull:",
            @"\U0001F634", @":sleeping:",
            @"\U0001F62A", @":sleepy:",
            @"\U0001F3B0", @":slot_machine:",
            @"\U0001F539", @":small_blue_diamond:",
            @"\U0001F538", @":small_orange_diamond:",
            @"\U0001F53A", @":small_red_triangle:",
            @"\U0001F53B", @":small_red_triangle_down:",
            @"\U0001F604", @":smile:",
            @"\U0001F638", @":smile_cat:",
            @"\U0001F603", @":smiley:",
            @"\U0001F63A", @":smiley_cat:",
            @"\U0001F608", @":smiling_imp:",
            @"\U0001F60F", @":smirk:",
            @"\U0001F63C", @":smirk_cat:",
            @"\U0001F6AC", @":smoking:",
            @"\U0001F40C", @":snail:",
            @"\U0001F40D", @":snake:",
            @"\U0001F3C2", @":snowboarder:",
            @"\u2744", @":snowflake:",
            @"\u26C4", @":snowman:",
            @"\U0001F62D", @":sob:",
            @"\u26BD", @":soccer:",
            @"\U0001F51C", @":soon:",
            @"\U0001F198", @":sos:",
            @"\U0001F509", @":sound:",
            @"\U0001F47E", @":space_invader:",
            @"\u2660", @":spades:",
            @"\U0001F35D", @":spaghetti:",
            @"\U0001F387", @":sparkler:",
            @"\u2728", @":sparkles:",
            @"\U0001F496", @":sparkling_heart:",
            @"\U0001F64A", @":speak_no_evil:",
            @"\U0001F50A", @":speaker:",
            @"\U0001F4AC", @":speech_balloon:",
            @"\U0001F6A4", @":speedboat:",
            @":squirrel:", @":squirrel:",
            @"\U0001F31F", @":star:",
            @"\U0001F31F", @":star2:",
            @"\U0001F303", @":stars:",
            @"\U0001F689", @":station:",
            @"\U0001F5FD", @":statue_of_liberty:",
            @"\U0001F682", @":steam_locomotive:",
            @"\U0001F372", @":stew:",
            @"\U0001F4CF", @":straight_ruler:",
            @"\U0001F353", @":strawberry:",
            @"\U0001F61B", @":stuck_out_tongue:",
            @"\U0001F61D", @":stuck_out_tongue_closed_eyes:",
            @"\U0001F61C", @":stuck_out_tongue_winking_eye:",
            @"\U0001F31E", @":sun_with_face:",
            @"\U0001F33B", @":sunflower:",
            @"\U0001F60E", @":sunglasses:",
            @"\u2600", @":sunny:",
            @"\U0001F305", @":sunrise:",
            @"\U0001F304", @":sunrise_over_mountains:",
            @"\U0001F3C4", @":surfer:",
            @"\U0001F363", @":sushi:",
            @":suspect:", @":suspect:",
            @"\U0001F69F", @":suspension_railway:",
            @"\U0001F613", @":sweat:",
            @"\U0001F4A6", @":sweat_drops:",
            @"\U0001F605", @":sweat_smile:",
            @"\U0001F360", @":sweet_potato:",
            @"\U0001F3CA", @":swimmer:",
            @"\U0001F523", @":symbols:",
            @"\U0001F489", @":syringe:",
            @"\U0001F389", @":tada:",
            @"\U0001F38B", @":tanabata_tree:",
            @"\U0001F34A", @":tangerine:",
            @"\u2649", @":taurus:",
            @"\U0001F695", @":taxi:",
            @"\U0001F375", @":tea:",
            @"\u260E", @":telephone:",
            @"\U0001F4DE", @":telephone_receiver:",
            @"\U0001F52D", @":telescope:",
            @"\U0001F3BE", @":tennis:",
            @"\u26FA", @":tent:",
            @"\U0001F4AD", @":thought_balloon:",
            @"\U0001F44E", @":thumbsdown:",
            @"\U0001F44D", @":thumbsup:",
            @"\U0001F3AB", @":ticket:",
            @"\U0001F42F", @":tiger:",
            @"\U0001F405", @":tiger2:",
            @"\U0001F62B", @":tired_face:",
            @"\u2122", @":tm:",
            @"\U0001F6BD", @":toilet:",
            @"\U0001F5FC", @":tokyo_tower:",
            @"\U0001F345", @":tomato:",
            @"\U0001F61D", @":tongue:",
            @"\U0001F445", @":tongue2:",
            @"\U0001F51D", @":top:",
            @"\U0001F3A9", @":tophat:",
            @"\U0001F69C", @":tractor:",
            @"\U0001F6A5", @":traffic_light:",
            @"\U0001F683", @":train:",
            @"\U0001F686", @":train2:",
            @"\U0001F68A", @":tram:",
            @"\U0001F6A9", @":triangular_flag_on_post:",
            @"\U0001F4D0", @":triangular_ruler:",
            @"\U0001F531", @":trident:",
            @"\U0001F624", @":triumph:",
            @"\U0001F68E", @":trolleybus:",
            @":trollface:", @":trollface:",
            @"\U0001F3C6", @":trophy:",
            @"\U0001F379", @":tropical_drink:",
            @"\U0001F420", @":tropical_fish:",
            @"\U0001F69A", @":truck:",
            @"\U0001F3BA", @":trumpet:",
            @"\U0001F455", @":tshirt:",
            @"\U0001F337", @":tulip:",
            @"\U0001F422", @":turtle:",
            @"\U0001F4FA", @":tv:",
            @"\U0001F500", @":twisted_rightwards_arrows:",
            @"\U0001F495", @":two_hearts:",
            @"\U0001F46C", @":two_men_holding_hands:",
            @"\U0001F46D", @":two_women_holding_hands:",
            @"\U0001F239", @":u5272:",
            @"\U0001F234", @":u5408:",
            @"\U0001F23A", @":u55b6:",
            @"\U0001F22F", @":u6307:",
            @"\U0001F237", @":u6708:",
            @"\U0001F236", @":u6709:",
            @"\U0001F235", @":u6e80:",
            @"\U0001F21A", @":u7121:",
            @"\U0001F238", @":u7533:",
            @"\U0001F232", @":u7981:",
            @"\U0001F233", @":u7a7a:",
            [NSString stringWithFormat:@"%C%C%C%C", (unichar)0xD83C, (unichar)0xDDEC, (unichar)0xD83C, (unichar)0xDDE7], @":uk:",
            @"\u2614", @":umbrella:",
            @"\U0001F612", @":unamused:",
            @"\U0001F51E", @":underage:",
            @"\U0001F513", @":unlock:",
            @"\U0001F199", @":up:",
            [NSString stringWithFormat:@"\U0001F1FA\U0001F1F8"], @":us:",
            @"\u270C", @":v:",
            @"\U0001F6A6", @":vertical_traffic_light:",
            @"\U0001F4FC", @":vhs:",
            @"\U0001F4F3", @":vibration_mode:",
            @"\U0001F4F9", @":video_camera:",
            @"\U0001F3AE", @":video_game:",
            @"\U0001F3BB", @":violin:",
            @"\u264D", @":virgo:",
            @"\U0001F30B", @":volcano:",
            @"\U0001F19A", @":vs:",
            @"\U0001F6B6", @":walking:",
            @"\U0001F318", @":waning_crescent_moon:",
            @"\U0001F316", @":waning_gibbous_moon:",
            @"\u26A0", @":warning:",
            @"\u231A", @":watch:",
            @"\U0001F403", @":water_buffalo:",
            @"\U0001F349", @":watermelon:",
            @"\U0001F44B", @":wave:",
            @"\u3030", @":wavy_dash:",
            @"\U0001F312", @":waxing_crescent_moon:",
            @"\U0001F314", @":waxing_gibbous_moon:",
            @"\U0001F6BE", @":wc:",
            @"\U0001F629", @":weary:",
            @"\U0001F492", @":wedding:",
            @"\U0001F433", @":whale:",
            @"\U0001F40B", @":whale2:",
            @"\u267F", @":wheelchair:",
            @"\u2705", @":white_check_mark:",
            @"\u26AA", @":white_circle:",
            @"\U0001F4AE", @":white_flower:",
            @"\u2B1C", @":white_square:",
            @"\U0001F533", @":white_square_button:",
            @"\U0001F390", @":wind_chime:",
            @"\U0001F377", @":wine_glass:",
            @"\U0001F609", @":wink:",
            @"\U0001F61C", @":wink2:",
            @"\U0001F43A", @":wolf:",
            @"\U0001F469", @":woman:",
            @"\U0001F45A", @":womans_clothes:",
            @"\U0001F452", @":womans_hat:",
            @"\U0001F6BA", @":womens:",
            @"\U0001F61F", @":worried:",
            @"\U0001F527", @":wrench:",
            @"\u274C", @":x:",
            @"\U0001F49B", @":yellow_heart:",
            @"\U0001F4B4", @":yen:",
            @"\U0001F60B", @":yum:",
            @"\u26A1", @":zap:",
            @"\U0001F4A4", @":zzz:",
            nil];
	
	// Build dictionary keyed by unicode representation for easy replacement
	NSMutableDictionary *emojis = [[NSMutableDictionary alloc] init];
		
	[_codes enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) {
		[emojis setObject:key forKey:obj];
	}];
	
	_emojis = emojis;
}

@end
